{
  "meta": {
    "name": "3D Pinball",
    "gamerule": ["top_n", "last_n"],
    "live_ranking": {
      "type": "distance",
      "target_id": "goal"
    }
  },
  "objects": [
    {
      "role": "spawner",
      "shape": { "type": "rect", "center": [3.0, 9.0], "size": [4.0, 0.8], "rotation": 0.0 },
      "properties": { "spawn": { "mode": "random", "initial_force": "random" } }
    },

    { "role": "obstacle", "shape": { "type": "line", "start": [0.0, 10.0], "end": [6.0, 10.0] } },
    { "role": "obstacle", "shape": { "type": "line", "start": [6.0, 10.0], "end": [6.0, 0.0] } },
    { "role": "obstacle", "shape": { "type": "line", "start": [6.0, 0.0], "end": [0.0, 0.0] } },
    { "role": "obstacle", "shape": { "type": "line", "start": [0.0, 0.0], "end": [0.0, 10.0] } },

    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [1.5, 7.5], "radius": 0.25 },
      "properties": { "bumper": { "force": 1.2 } }
    },
    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [3.0, 7.5], "radius": 0.25 },
      "properties": { "bumper": { "force": 1.2 } }
    },
    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [4.5, 7.5], "radius": 0.25 },
      "properties": { "bumper": { "force": 1.2 } }
    },

    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [2.0, 6.5], "radius": 0.22 },
      "properties": { "bumper": { "force": 1.0 } }
    },
    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [4.0, 6.5], "radius": 0.22 },
      "properties": { "bumper": { "force": 1.0 } }
    },

    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [1.2, 5.5], "radius": 0.2 },
      "properties": { "bumper": { "force": 0.9 } }
    },
    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [4.8, 5.5], "radius": 0.2 },
      "properties": { "bumper": { "force": 0.9 } }
    },
    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [3.0, 5.0], "radius": 0.18 },
      "properties": { "bumper": { "force": 0.8 } }
    },

    {
      "id": "spinner_left",
      "role": "obstacle",
      "shape": { "type": "rect", "center": [1.5, 4.4], "size": [1.3, 0.08], "rotation": 0.0 },
      "properties": { "roll": { "direction": "clockwise", "speed": 130.0 } }
    },
    {
      "id": "spinner_right",
      "role": "obstacle",
      "shape": { "type": "rect", "center": [4.5, 4.4], "size": [1.3, 0.08], "rotation": 0.0 },
      "properties": { "roll": { "direction": "counterclockwise", "speed": 130.0 } }
    },

    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [2.2, 3.5], "radius": 0.18 },
      "properties": { "bumper": { "force": 0.7 } }
    },
    {
      "role": "obstacle",
      "shape": { "type": "circle", "center": [3.8, 3.5], "radius": 0.18 },
      "properties": { "bumper": { "force": 0.7 } }
    },
    {
      "id": "flipper_left",
      "role": "obstacle",
      "shape": { "type": "rect", "center": [1.6, 1.5], "size": [1.2, 0.12], "rotation": -20.0 }
    },
    {
      "id": "flipper_right",
      "role": "obstacle",
      "shape": { "type": "rect", "center": [4.4, 1.5], "size": [1.2, 0.12], "rotation": 20.0 }
    },

    { "role": "obstacle", "shape": { "type": "line", "start": [0.0, 3.0], "end": [2.3, 0.0] } },
    { "role": "obstacle", "shape": { "type": "line", "start": [6.0, 3.0], "end": [3.7, 0.0] } },

    {
      "id": "goal_field",
      "role": "vector_field",
      "shape": { "type": "circle", "center": [3.0, 0.5], "radius": 0.6 },
      "properties": {
        "vector_field": {
          "direction": [0.0, -1.0],
          "magnitude": "min(0.001 + 0.002 * game.time, 0.1)",
          "enabled": true,
          "falloff": "distance_based"
        }
      }
    },
    {
      "id": "goal",
      "role": "trigger",
      "shape": { "type": "circle", "center": [3.0, 0.5], "radius": 0.45 },
      "properties": {
        "trigger": { "action": "gamerule" }
      }
    }
  ],
  "keyframes": [
    {
      "name": "flipper_left_cycle",
      "target_ids": ["flipper_left"],
      "autoplay": true,
      "keyframes": [
        { "type": "loop_start" },
        { "type": "delay", "duration": "random(1, 3.0)" },
        { "type": "pivot_rotate", "pivot": [0.8, 1.5], "angle": 35.0, "duration": 0.1, "easing": "ease_out" },
        { "type": "delay", "duration": 0.1 },
        { "type": "pivot_rotate", "pivot": [0.8, 1.5], "angle": 0.0, "duration": 0.15, "easing": "ease_in" },
        { "type": "loop_end" }
      ]
    },
    {
      "name": "flipper_right_cycle",
      "target_ids": ["flipper_right"],
      "autoplay": true,
      "keyframes": [
        { "type": "loop_start" },
        { "type": "delay", "duration": "random(1, 3.0)" },
        { "type": "pivot_rotate", "pivot": [5.2, 1.5], "angle": -35.0, "duration": 0.1, "easing": "ease_out" },
        { "type": "delay", "duration": 0.1 },
        { "type": "pivot_rotate", "pivot": [5.2, 1.5], "angle": 0.0, "duration": 0.15, "easing": "ease_in" },
        { "type": "loop_end" }
      ]
    }
  ]
}
