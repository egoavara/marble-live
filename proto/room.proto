syntax = "proto3";

package room;

// Room service for managing game sessions
service RoomService {
  // Create a new room
  rpc CreateRoom(CreateRoomRequest) returns (CreateRoomResponse);

  // Join an existing room
  rpc JoinRoom(JoinRoomRequest) returns (JoinRoomResponse);

  // Join an existing room
  rpc StartRoom(StartRoomRequest) returns (StartRoomResponse);

  // Join an existing room
  rpc KickRoom(KickRoomRequest) returns (KickRoomResponse);

  // Get room info
  rpc GetRoom(GetRoomRequest) returns (GetRoomResponse);

  // Get room player info
  rpc GetRoomPlayer(GetRoomPlayerRequest) returns (GetRoomPlayerResponse);
}

message CreateRoomRequest {
  PlayerAuth host = 1;
  uint32 max_players = 2;
}

message CreateRoomResponse {
  string room_id = 1;
  string signaling_url = 2;
}

message JoinRoomRequest {
  string room_id = 1;
  PlayerAuth player = 2;
}

message JoinRoomResponse {
  string signaling_url = 3;
}

message StartRoomRequest {
  string room_id = 1;
  PlayerAuth player = 2;
}

message StartRoomResponse {
  string started_at = 1;
}


message KickRoomRequest {
  string room_id = 1;
  PlayerAuth player = 2;
  string target_player = 3;
}

message KickRoomResponse {
}

message GetRoomRequest {
  string room_id = 1;
}

message GetRoomResponse {
  RoomInfo room = 1;
}

message GetRoomPlayerRequest {
  string room_id = 1;
}

message GetRoomPlayerResponse {
  repeated PlayerInfo players = 1;
}

message RoomInfo {
  string id = 1;
  uint32 max_players = 2;
  RoomState state = 3;
  string started_at = 4;
}

enum RoomState {
  UNDEFINED = 0;
  WAITING = 1;
  STARTED = 2;
}

message PlayerAuth {
  string id = 1;
  string secret = 2;
}

message PlayerInfo {
  string id = 1;
  bool is_host = 2;
  string display_id = 3;
}